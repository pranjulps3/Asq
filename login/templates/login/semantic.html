<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Required meta tags always come first -->
    {% load crispy_forms_tags %}
        <title>{{ title }}</title>
        {% load staticfiles %}
        {% load static %}
        {% load notifications_tags %}
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <script type="text/javascript" src={% static 'js/jquery-3.2.0.min.js' %}></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/marked/0.3.6/marked.js"></script>
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>{{title}}</title>
    <!-- Font Awesome -->
    <link rel="stylesheet" href={% static 'sem/semantic.min.css' %} >
    <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Lato">
    <!-- CSS -->
    <script src={% static 'sem/components/sidebar.min.js' %} type="text/javascript"></script>
    <script src={% static 'sem/components/search.min.js' %} type="text/javascript"></script>
    <script src={% static 'sem/components/transition.min.js' %} type="text/javascript"></script>
    <script src={% static 'sem/components/dropdown.min.js' %} type="text/javascript"></script>
    <script src={% static 'sem/components/popup.min.js' %} type="text/javascript"></script>
    <script src={% static 'sem/components/modal.min.js' %} type="text/javascript"></script>
        <script src={% static 'sem/components/dimmer.min.js' %} type="text/javascript"></script>
        <script src={% static 'sem/components/checkbox.min.js' %} type="text/javascript"></script>
        <script src={% static 'sem/components/tab.min.js' %} type="text/javascript"></script>
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/styles/default.min.css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/highlight.min.js"></script>
    <style>
        body{
          background-color: rgba(230,230,230,1);
            /*background-image:url({% static 'img/paper-background-7.jpg' %});*/
        }

        h3{
          font-family: Lato;
          font-size: 1.6em;
        }

        *{
          font-family: Lato;
        }

        #id_comment {
                     resize: none;
                     border-right-width: 0px;
                     border-radius: 0px;
        }

        #add-emoji
        {
            border-left-width: 0px;
            border-left: 0px;
            border-right-width: 0px;
            border-radius: 0px;
        }


    
        img{
            width:25em;
            height: auto;
        }

        li{
            text-decoration:none;
        }
    </style>
</head>
<body class="body">
    <div class="ui black sidebar inverted vertical menu">
    <a class="item" href="http://www.github.com/pranjulps3" target="_blank">
      <i class="github icon" ></i> Pranjul
    </a>
    <a class="item" href="http://www.github.com/samy-33" target="_blank">
      <i class="github icon" ></i> Saket
    </a>
    <a class="item" href="http://www.github.com/aryanakul" target="_blank">
      <i class="github icon" ></i> Nakul
    </a>
  </div>

  <div class="pusher" >
    <!-- Site content !-->

    <div class="sixteen fixed wide column">
    <div class="ui black inverted fixed pointing menu" >
      <a class="item" id="sidenav" style="border-radius: 0px;">
            <i class="content icon"></i>
          </a>
        <a href="/" class="item" style="background-color: rgba(200,200,200,1); border-radius: 4px; border: 2px solid; border-color: rgba(10,10,10,0.92); padding-top: 2px; padding-bottom: 2px; margin-top: 0px; margin-bottom: 0px;margin-right: 0px">
            <img class="ui transparent tiny image" id="logo-asq" style="height: 3em; width: auto;" src={% static 'img/asq.png' %}/>
        </a>
        <div class="ui dropdown item" style="width: 4%;">
                <i class="chevron down icon"></i>
                <div class="menu">
                  <a href="/post/" class="item"><i class="edit icon"></i> Post</a>
                  <a href="/" class="item"><i class="browser icon"></i> feed</a>
                </div>
         </div>
         &emsp;&emsp;&emsp;
    <div class="center menu" style="width: 39%;">
        <div class="item" style="width: 100%; ">
          <div class="ui icon input">
            <input type="text" placeholder="Ask anything..." style="width: 100%; ">
            <i class="black search link icon"></i>
      </div>
    </div>
    </div>

       
  <div class="right menu">
  <a class="teal item" id='varta_chat' href="#">
            {% csrf_token %}
            <i class="record icon"></i>Varta</a>
  <a class="teal item">
            Notifications 

            <div class="ui teal left pointing label">
  {% live_notify_badge classes="badge" %}</div>
          </a>
          <!-- <a class="item">
               <div class="results">{% live_notify_list classes="results" %}</div>
          </a> -->
  <a class="item" id=modal>
  <i class="send outline icon"></i>
    Messages
  </a>
  <div class="ui dropdown item">
    More
    <i class="dropdown icon"></i>
    <div class="menu">
      <a class="item" href="{% url 'fillup' %}"><i class="edit icon"></i> Edit Profile</a>
      <a class="item" href="/accounts/password/change/"><i class="settings icon"></i>Change Password</a>
      <a class="item" href="{% url 'logout' %}"><i class="power off icon"></i> logout</a>
    </div>
  </div>
  </div>
</div>
    </div> 
    <br><br>
<br>
  <div class="ui grid">
          <div class="three wide column">
          <div class="ui black vertical menu" style="position: fixed; margin-left: 1.7%; ">
          <div class="ui black fluid card" style="background-color: rgba(10,10,10,0.92);color: white;">
                    <div class=" item">
                        <!-- <div class="ui input"><form class="search-form" role="search">
                            <div class="ui loading search">
                                <div style="width:30vh">
                                    {% csrf_token %}
                                    <input type="text" class="form-control" id="profile-search" name="search" placeholder="Find Friends...." list="profile-results">
                                    <div class="results" id="profile-results" >
                                    </div>
                                </div>
                            </div>
                        </form></div> -->
                        <div class="ui fluid inverted search" id="profile-search-div">
                        <div class="ui transparent icon input" >
                          {% csrf_token %}
                            <input class="prompt" id="profile-search" type="text" placeholder="Find People..." style="border-radius: 0px;color: white;" >
                            <i class="white inverted search icon"></i>
                        </div>
                              <div class="results" id="profile-results" >
                              </div>
                        </div>
                    </div>   
                  <div class="image">
                    {% if user.person.display_pic %}
                      <img src="{{user.person.display_pic.url}}" style="display: inline;"/>
                      {% else %}
                      <img src= {% static 'img/dummy_user.png' %} style="display: inline;"/>
                      {% endif %} 
                  </div>
                  <div class="ui content">
                    <a class="header" href="{% url 'profile_view' request.user.id %}" style="color: white;text-decoration-color: blue;">
                          {% if user.first_name %}
                          {{ user.first_name }}&nbsp;{{ user.last_name }}
                          {% else %}
                          {{ user.username }}
                          {% endif %} 
                    </a>
                    <div class="meta">
                      <span class="date" style="color: white;">Joined on {{ user.date_joined }}</span>
                    </div>
                    <div class="description" style="color: white;">
                      {{ user.person.about_me }}
                    </div>
                  </div>
                  <div class="extra content">
                    <a style="color: white; text-decoration-color: blue;">
                      <i class="user icon"></i>
                      {{ user.person.followed_by.all.count }}&nbsp;follower{% if user.person.followed_by.all.count > 1 %}s{% endif %}
                    </a>
                  </div>
            </div>
          
        </div>
  </div>
  <div class="seven wide stretched column" >
    <div class="ui inverted raised segment" style="border-radius: 5px;">
    <a href="{% url 'create_question' %}" class="ui inverted button">
        <div class="two wide stretched column">
        <h2> Ask a Question </h2>
        </div>
    </a>
    <a href="{% url 'create_post' %}" class="ui right floated inverted button">
        <div class="two wide stretched column">
        <h2> Create Post</h2>
        </div>
    </a>
    </div>
            <div class="ui modal" style="padding: 0px;">
              <i class="close icon"></i>
              
            </div>
    
      {% block body %}
      {% endblock %}
</div>
    <div class="three wide column" style="float: right;">
    <div  style="position: fixed; width:18%;">
    
    <div>
    
          <table class="ui selectable inverted compact fixed table">
          <thead>
          <!-- <tr class = "ui yellow top attched segment""><th colspan="2" ><center><b> LOST</b></center> </th></tr> -->
            <tr>
            <th colspan="2">Reported by</th>
            <th colspan="1">Item name</th>
          </tr></thead>
          <tbody>
          {% load post_tags %}
          {% for item in litem %}
          
            <tr>
              <td colspan="2">{% get_user_popup item.reported_by user %}</td>
              <td colspan="1" href="{% url 'lost_view' item.id %}"><a href="{% url 'lost_view' item.id %}">{{ item.name }}</a></td>

            </tr>

            {% endfor %}
          </tbody>
          
        </table>
        
          <table class="ui inverted selectable compact fixed table">
          <thead>
        <!--  <tr class = "ui inverted yellow top attched segment""><th colspan="2"><center><b> FOUND</b></center> </th></tr> -->
            <tr >
            <th colspan="2">Reported by</th>
            <th colspan="1">Item name</th>
          </tr></thead>
          <tbody>
            {% for item in fitem %}
            
            <tr>
              <td colspan="2">{% get_user_popup item.reported_by user %}</td>
              <td colspan="1" href="{% url 'lost_view' item.id %}"><a href="{% url 'lost_view' item.id %}">{{ item.name }}</a></td>
            </tr>
            
            {% endfor %}
          </tbody>
          
        </table>
      
      </div>
      <a class = "ui bottom attached teal button" href="{% url 'report' %}" class="ui small teal button">Report Item Lost/Found</a>
      </div>
      </div>
</div>
</div>
</div></div></div></div></body>

<script type="text/javascript">
  document.load(function(){
    $('.ui.modal').modal('show');
  });
</script>
 
    <script type="text/javascript">
$('#sidenav').click(function(event){
    $('.ui.sidebar')
  .sidebar('toggle')
;
});

$('#modal').click(function(event){
$('.ui.modal')
  .modal('show')
;
});
        
    </script>

<!-- <script type="text/javascript">
    $('.post-edit').click(function(event){
        var element = $(this);
        $('.ui.modal').modal('show'); 
        $.ajax({
               type: "POST",
               url: "/post/update/"+element.attr('data')+"/",
               data: { 'post_id': element.attr('data'),'csrfmiddlewaretoken': '{{ csrf_token }}'},
               dataType: "json",
               success: function(response) {
                      if(response['data'])
                      {
                      $('.ui.modal').html(response['html']); 
                      console.log($('.ui.modal').html());
                      // console.log('follow-'+element.attr('data'));
                      // document.getElementById('follow-'+element.attr('data')).style.color = 'red';
                        
                        }
                        else
                        {
                            $('.ui.modal').html("<h3>Something went wrong</h3>"); 
                            // console.log('follow-'+element.attr('data'));
                            // document.getElementById('follow-'+element.attr('data')).style.color = 'black';
                            
                        }

                },
                error: function(rs, e) {
                       $('.ui.modal').html("<h3>Request couldn't be parsed</h3>"); 
                },
            });
    });
</script> -->


    <script type="text/javascript">
      $(function(){
        $('#profile-search').keyup(function(){
          document.getElementById('profile-search-div').classList.add('loading');
          $.ajax({
            type :'POST',
            url :'{% url 'profile_search' %}',
            data : {
              'search_q':$('#profile-search').val(),
              'csrfmiddlewaretoken': $('input[name=csrfmiddlewaretoken]').val(),
            },
            dataType : "json",
            success: function(data){
              document.getElementById('profile-search-div').classList.remove('loading');
                if(data['data'])
                {
                $('#profile-results').show();
                }
                else{$('#profile-results').hide();}
              $('#profile-results').html(data['html']);


            },
            error: function(rs, e){
              console.log('Something went wrong!!');
              document.getElementById('profile-search-div').classList.add('loading');
            },


          })

        })

      })

    </script>

<script type="text/javascript">
$('.profiles').click(function(){
    var element = $(this);
      $.ajax({
               type: "POST",
               url: "{% url 'follow_request'%}",
               data: {'user_id': $(this).attr('data'), 'csrfmiddlewaretoken': '{{ csrf_token }}'},
               dataType: "json",
               success: function(response) {
                      if(response.message == "followed")
                      {
                      element.html("<div class='ui purple labeled icon button'><i class='user icon'></i>unfollow</div>");
                      // console.log('follow-'+element.attr('data'));
                      // document.getElementById('follow-'+element.attr('data')).style.color = 'red';
                        
                        }
                        else
                        {
                            element.html("<div class='ui basic purple labeled icon button'><i class='add user icon'></i>follow</div>");
                            // console.log('follow-'+element.attr('data'));
                            // document.getElementById('follow-'+element.attr('data')).style.color = 'black';
                            
                        }

                },
                error: function(rs, e) {
                       alert("Something went wrong!")//rs.responseText);
                }
          }); 
    })

    </script>
    <script type="text/javascript">
$('.ui.image.label')
  .popup({
    inline     : true,
    hoverable  : true,
    position   : 'bottom left',
    delay: {
      show: 300,
      hide: 500
    }
  })
;

$('.ui.transparent.label')
  .popup({
    inline     : true,
    hoverable  : true,
    position   : 'bottom left',
    delay: {
      show: 300,
      hide: 500
    }
  })
;

$('.ui.emoji.label')
  .popup({
    on         : 'click',
    inline     : true,
    hoverable  : true,
    position   : 'bottom left',
    delay: {
      show: 300,
      hide: 500
    }
  })
;

$('.ui.emoji.button').click(function(event){
  var emoji = event.currentTarget;
  var element = event.currentTarget.parentElement.parentElement;
  var elem = element.getElementsByClassName('comment-form-class').comment;
  // console.log(elem.value);
  var str=elem.value+emoji.innerText;
  elem.value=str;
});
</script>
<script type="text/javascript">





// $('.ui.transparent.icon.input')
//   .click(function(){
//     //$('.body').dimmer('show');
//     //$('.ui.black.fluid.card').dimmer('show');
//     $('.ui.search').dimmer("add content('.ui.search')");

//   })
// ;



    $('.dropdown')
  .dropdown({
    // you can use any ui transition
    transition: 'slide'
  })
;
</script>
<script type="text/javascript">
  $('img').click(function(event){
    if(event.currentTarget.id!='logo-asq' && event.currentTarget.id!='avatar-image')
    {
    var modal = $('.ui.modal');
    modal.html("<i class='close icon' id='modal-close-button'></i><center style='padding:0px;'><img class='ui big image' style='padding:0px;' src='"+event.currentTarget.src+"'/></center>");
    modal.modal('show');
  }
  });
  $('#modal-close-button').click(function(){
      console.log('grabbed');
      $('.ui.modal').html("<i class='close icon'></i>");
  });
</script>
<script type="text/javascript">
  $('#varta_chat').click(function(event){
    var element = $(this);
      $.ajax({
               type: "POST",
               url: "{% url 'varta_chat'%}",
               data: {'user_id': {{request.user.id}},'csrfmiddlewaretoken': '{{ csrf_token }}'},
               dataType: "json",
               success: function(response) {
                      $('.ui.modal').html("<i class='close icon'></i>"+response.html);
                      $('.ui.modal').modal('show');
                },
                error: function(rs, e) {
                       alert("Something went wrong!")//rs.responseText);
                }
          }); 
  },);
</script>
<script>hljs.initHighlightingOnLoad();</script>
</body>
</html>
